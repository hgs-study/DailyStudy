## jenkins server
-------
 + 자바 설치 - sudo apt-get install openjdk-8-jdk
 + 그레이들 설치 - https://www.dante2k.com/566
 + 깃 설치
 + 도커 설치 - https://blog.cosmosfarm.com/archives/248/%EC%9A%B0%EB%B6%84%ED%88%AC-18-04-%EB%8F%84%EC%BB%A4-docker-%EC%84%A4%EC%B9%98-%EB%B0%A9%EB%B2%95/
 + 젠킨스 설치 - https://velog.io/@ifthenelse/jenkins-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-ubuntu-20.04
 + 개인키 / 공개키 쌍 생성 : ssh-keygen -t rsa -f ~/.ssh/id_rsa
  + 키 경로 : /home/ubuntu/.ssh/id_rsa.pub.(키가 생성되면 cli창에 경로 나옴)
  + id_rsa : 개인키 
  + id_rsa_pub : 공개키
  + 공개키를 워커 인스턴스에 등록해줘야한다.(워커 인스턴스로 이동!!)
+ worker server에 공개키 등록 & 권한 변경 후
+ 젠킨스 관리 - 시스템 설정 - Publish over SSH에 젠킨스 개인키와 SSH Servers에 worker server를 등록해야한다.
  + Publish over SSH
    + key에 젠킨스 서버 개인키 등록 (-----BEGIN RSA PRIVATE KEY-----로 시작)
  + ssh servers
    +  Hostname : SSH Servers에 worker server 등록할 때 내부 IP를 사용하면 된다.
    +  Username : worker server 계정명
    +  Remote Directory : worker server 홈(~) 디렉토리 경로
  + 설정이 다 되면 test configuration -> 정상이면 success가 뜸
+ new Item 클릭
  + worker-server-01 deploy라고 네이밍 한 후 
  + 빌드 후 조치 - Send build artifacts over SSH에 worker-server-01 선택
  + [고급] - [Verbose output in console] 체크 : 로그를 자세히 출력해준다.
  + Exec command에 도커 run 명령어 삽입 : nohup docker run -p 8080:8080 hgstudy/jenkins-test > /dev/null 2>&1 &
   + "nohup" ~ "맨 끝 &" : 백그라운드로 실행
   + "> /dev/null 2>&1" : 표준 에러를 표준 출력으로
  + 도커 설치 ( -> worker server) 
  

## worker server
-------
  + 키를 등록해야하는 경로 : vim ~/.ssh/authorized_keys
    + 이 곳에 젠킨스 인스턴스의 공개키(id_rsa_pub)를 넣어줌
  + 폴더 권한 변경 (chmod 700 ~/.ssh)
  + 키 권한 변경 (chmod 600 ~/.ssh/authorized_keys)
  + ( -> jenkins server) 도커 설치 
   + 권한 에러 : sudo chmod 666 /var/run/docker.sock
