## 1% 네트워크 원리

## TCP/IP의 데이터를 전기신호로 만들어 보낸다.
----
![image](https://user-images.githubusercontent.com/76584547/154080289-9de6e873-1de7-49b2-9b88-44fba80d1d5b.png)

+ `프로토콜 스택`
  + 네트워크 제어용 소프트웨어
  + 브라우저에서 받은 메시지를 패킷 속에 저장하고, 수신처 주소 등의 제어 정보를 덧붙인다.
  + 통신 오류가 발생했을 때 패킷을 고쳐서 보내거나 데이터 통신의 기본을 조절
  + 패킷을 LAN 어댑터에 넘긴다.
  + 그리고 LAN 어댑터가 이것을 전기 신호로 변환하고, LAN의 케이블에 송출하는 과정을 통해 패킷이 네트워크 속으로 들어간다.


## 1. 소켓을 작성한다.
---

### 1-1. 프로토콜 스택의 내부 구성
---
![image](https://user-images.githubusercontent.com/76584547/154081106-7aaa1cd3-b3d7-43ce-ab08-24c33f8d205e.png)
+ 네트워크 애플리케이션
  + `소켓`이 있으며 그 안에는 `리졸버`가 존재해서 DNS 서버에 조회하는 동작
+ 프로토콜 스택
  + `TCP` : 일반적인 애플리케이션이나 메일 등 데이터 송수신
  + `UDP` : DNS 조회 등 짧은 제어용 데이터 송수신
  + `IP`  : 패킷 송수신
    + `ICMP` : 패킷을 운반할 때 발생하는 오류를 통지하거나 제어용 메시지 통지
    + `ARP`  : IP주소에 대응하는 이더넷의 `MAC 주소`를 조사할 때 사용
  + `패킷` : 인터넷에서 데이터를 운반할 때는 데이터를 작게 나누어 `패킷`이라고 칭함
    + 이 패킷을 통신 상대까지 운반하는 것이 IP의 주 역할 
+ LAN 드라이버
  + LAN 어댑터의 하드웨어를 제어 
  
### 1-2. 소켓의 실체는 통신 제어용 제어 정보
---
+ `소켓의 실체`
  + 프로토콜 스택의 내부에 제어 정보를 기록하는 메모리 영역을 가지고 있으며, 여기에 통신 동작을 제어하기 위한 제어 정보를 기록한다.
    + 대표적인 정보는 통신 상대의 IP주소는 무엇인가?
    + 포트 번호는 몇번인가?
    + 통신 동작이 어떤 진행 상태에 있는가?
  + 이 제어 정보가 소켓의 실체, 또는 제어 정보를 기록한 메모리 영역이 소켓의 실체
  + `프로토콜 스택은 소켓에 기록된 제어 정보를 참조하면서 움직인다.`

+ 소켓 정보 확인
  + 윈도우 `netstat`은 소켓의 내용을 표시, `-ano`
    + a : 통신중인 것뿐만 아니라 통신 개시 전의 것도 포함하여 전부 표시
    + n : IP주소나 포트 번호를 번호로 표시
    + o : 소켓을 사용하고 있는 프로그램 PID 표시  
  ![image](https://user-images.githubusercontent.com/76584547/154091777-2dc50ab2-85a6-494d-8632-cb8ab2241b35.png)

  + 예를들어 5번째 행은 `PID`가 1720인 프로그램이
    + 118.42.2.212라는 IP주소를 할당한 LAN 어댑터를 사용하여
    + 222.233.53.144의 IP주소를 할당한 상대와 통신하고 있습니다.
    + 자신 포트번호 : 2477, 상대 80
    + 덧붙여 말하면 2477는 윈도우의 파일서버를 나타낸다
  + 예를들어 1번째 행 `PID`가 1200인 프로그램이
    + 135번 포트에 누군가가 접속하기 기다리는 상태
    + 이 행은 로컬측도 원격측도 IP주소가 0.0.0.0인데 이것은 아직 통신이 시작되지 않았기 떄문에

### 1-3. 소켓을 호출했을 때의 동작
----
![image](https://user-images.githubusercontent.com/76584547/154092964-56955cdf-fa62-4988-9226-c2f33e2f2626.png)

1. 소켓을 만든다
2. 이떄, 프로토콜 스택이 하는 일은 호켓 한 개 분량의 `메모리 영역을 확보`하는 것
3. 통신시 메모리 영역에 해당하는 제어 정보(IP주소,포트번호,통신동작)들을 저장한다
4. 소켓을 만들 때 한개의 메모리 영역을 확보하고 초기 상태라는 것을 이 영역에 저장
5. 소켓이 만들어지면 소켓을 나타내는 `디스크립터`를 애플리케이션에 알려준다.
6. 디스크립터를 받은 애플리케이션은 이후 프로토콜 스택에 데이터 송수진 동작을 의뢰할 때 디스크립터 통지
7. 디스크립터만 알고 있으면 어느 소켓인지, 통신 상대는 누구인지 등 애플리케이션쪽에서 일일리 통지를 받을 필요가 없어진다.

